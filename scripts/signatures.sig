signature cve_2022_26937 {
  ip-proto == udp
  dst-port == 111
  # RPC header
  payload /^.{4}\x00{4}\x00{3}(\x01|\x02|\x03)\x00\x01\x86\xa0\x00{3}(\x01|\x02|\x03|\x04)\x00{3}\x03/
  tcp-state originator
}

signature cve_2022_26937_2 {
  ip-proto == udp
  src-port == 111
  tcp-state responder
  # RPC header
  payload /^.{4}\x00{3}\x01\x00{4}/
  payload-size > 150
  requires-reverse-signature cve_2022_26937
  eval CVE202226937::match
}

signature cve_2022_26937_tcp {
  ip-proto == tcp
  dst-port == 111
  # RPC header
  payload /^.{8}\x00{4}\x00{3}(\x01|\x02|\x03)\x00\x01\x86\xa0\x00{3}(\x01|\x02|\x03|\x04)\x00{3}\x03/
  tcp-state originator
}

signature cve_2022_26937_2_tcp {
  ip-proto == tcp
  src-port == 111
  tcp-state responder
  # RPC header
  payload /^.{8}\x00{3}\x01\x00{4}/
  payload-size > 150
  requires-reverse-signature cve_2022_26937_tcp
  eval CVE202226937::match
}